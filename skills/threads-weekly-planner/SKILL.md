---
name: threads-weekly-planner
description: Генерация и планирование постов в Threads на неделю через Chrome DevTools MCP. Используй когда пользователь говорит "запланируй посты в Threads", "threads на неделю", "/threads-weekly-planner".
---

# Threads Weekly Planner

Скилл для генерации контента и автоматического планирования постов в Threads через Chrome DevTools MCP.

## Подготовка

1. Прочитай конфиг: `~/claude-config/skills/threads-weekly-planner/config.json`
2. Прочитай историю: `~/claude-config/skills/threads-weekly-planner/history.md`
3. Определи текущую дату и рассчитай даты для постов:
   - Начало: завтрашний день
   - Количество дней: `planningDays` из конфига
   - Время: `postingTimes` из конфига (по умолчанию 10:00 и 18:00 МСК)
   - Итого: `planningDays × postsPerDay` постов

## Шаг 1: Генерация заголовков

Сгенерируй заголовки/темы для постов. Количество = `planningDays × postsPerDay`.

**Контекст аккаунта:**
- Ниша: нейросети для экспертов и блогеров
- Аудитория: эксперты, инфобизнесмены, продюсеры, которые ведут блог
- Темы из конфига: `topics`
- Форматы из конфига: `formats`

**Правила генерации заголовков:**
- Чередуй форматы — не два одинаковых подряд
- Чередуй темы — не две одинаковые подряд
- Заголовки должны цеплять, вызывать интерес
- Не повторяй темы из `history.md`

**Вывод:** Покажи пронумерованный список заголовков с датами и временем публикации. Спроси пользователя через `AskUserQuestion`: одобрить, отредактировать или перегенерировать.

## Шаг 2: Генерация текстов постов

Для каждого одобренного заголовка сгенерируй полный текст поста.

**Правила текстов:**
- Пиши от первого лица, как практик
- Без хештегов
- Без эмодзи в начале поста
- Эмодзи: максимум 1-2 на пост, органично в тексте
- Одна мысль на пост
- Конкретика, примеры, цифры
- Разговорный, но экспертный тон

**Запрещённые приёмы:**
- "Это не X. Это Y."
- "А вы пробовали?"
- "Давайте разберёмся"
- "Вот что я понял"
- Списки больше 5 пунктов
- Вопросы в конце (кроме риторических)

**CTA:** Последняя часть ветки — ВСЕГДА фиксированный текст из `ctaMessage` в конфиге. Не меняй его, не добавляй к нему ничего. Это отдельная часть ветки, не часть основного текста.

**Важно:** Используй "ИИ", а не "AI" в текстах на русском языке.

### Алгоритм разбивки на части (multi-part thread)

Лимит одного поста в Threads — `charsPerPart` символов (по умолчанию 500). Длинный контент разбивается на цепочку постов. Последняя часть — всегда CTA.

**Алгоритм:**
1. Сгенерируй полный текст поста (до 2000 символов, без CTA)
2. Если текст ≤ `charsPerPart` символов → **2 части**: текст + CTA (отдельная часть)
3. Если текст > `charsPerPart` символов → **multi-part thread**:
   - Разбей текст на N контентных частей (N ≤ `maxPartsPerThread - 1`, т.к. последняя часть = CTA)
   - Каждая контентная часть: до `charsPerPart` символов, разбивать **по границе предложения**
   - Последняя часть (N+1): фиксированный `ctaMessage` из конфига
   - Если контентных частей получается больше `maxPartsPerThread - 1` — сократи текст
4. Оптимальная длина: 3-4 контентных части + CTA = 4-5 частей всего. Больше 5 — пользователи не дочитывают.

**Вывод:** Покажи все посты пользователю с нумерацией, датой/временем и счётчиком символов.
- Для каждого поста покажи каждую часть с разметкой `[1/N]`, `[2/N]`, ... `[N/N]` и счётчиком символов
- Последняя часть всегда помечена как `[CTA]`
- Спроси через `AskUserQuestion`: одобрить, отредактировать или перегенерировать отдельные посты

## Шаг 3: Публикация через Chrome DevTools MCP

ВАЖНО: Перед началом убедись, что Chrome открыт и MCP доступен. Если нет — попроси пользователя открыть Chrome.

### Алгоритм для КАЖДОГО поста (всегда multi-part: контент + CTA):

```
1. Перейди на threads.com (если ещё не там):
   → mcp__chrome-devtools__navigate_page(url: "https://www.threads.com")
   → Подожди загрузки

2. Найди кнопку "Создать":
   → mcp__chrome-devtools__take_snapshot()
   → Найди кнопку создания поста (обычно "Создать" или иконка с "+")
   → mcp__chrome-devtools__click(uid: <uid кнопки>)

3. Введи текст ПЕРВОЙ части:
   → mcp__chrome-devtools__take_snapshot()
   → Найди текстовое поле (textbox, multiline) в модалке "Новая ветка"
   → mcp__chrome-devtools__fill(uid: <uid поля>, value: <текст первой части>)

4. Для каждой следующей части (2, 3, ... N):
   → mcp__chrome-devtools__take_snapshot()
   → Найди кнопку "Добавить в ветку" (Add to thread) — под текстовым полем
   → mcp__chrome-devtools__click(uid: <uid кнопки "Добавить в ветку">)
   → mcp__chrome-devtools__take_snapshot()
   → Найди НОВОЕ текстовое поле (последнее добавленное)
   → mcp__chrome-devtools__fill(uid: <uid нового поля>, value: <текст текущей части>)
   → Повторять для каждой следующей части

5. После ввода всех частей — открой меню планирования:
   → mcp__chrome-devtools__take_snapshot()
   → Найди и кликни кнопку "Ещё" (три точки или "Ещё")
   → mcp__chrome-devtools__click(uid: <uid кнопки "Ещё">)

6. Выбери "Запланировать…":
   → mcp__chrome-devtools__take_snapshot()
   → mcp__chrome-devtools__click(uid: <uid "Запланировать…">)

7. Выбери дату:
   → mcp__chrome-devtools__take_snapshot()
   → Найди нужную дату в календаре (gridcell)
   → Если дата в следующем месяце — кликни "Следующий месяц" нужное количество раз
   → mcp__chrome-devtools__click(uid: <uid нужной даты>)

8. Установи время:
   → Найди поле часов (textbox "hh") и минут (textbox "mm")
   → mcp__chrome-devtools__fill(uid: <uid часов>, value: <часы>)
   → mcp__chrome-devtools__fill(uid: <uid минут>, value: <минуты>)

9. Подтверди расписание:
   → mcp__chrome-devtools__click(uid: <uid "Готово">)

10. Опубликуй (запланируй):
    → mcp__chrome-devtools__take_snapshot()
    → Найди кнопку "Запланировать" или "Опубликовать"
    → mcp__chrome-devtools__click(uid: <uid кнопки>)

11. Подожди 3 секунды перед следующим постом:
    → Используй Bash: sleep 3
```

### Обработка ошибок:
- Если элемент не найден — сделай повторный `take_snapshot` и попробуй ещё раз
- Если модалка не открылась — подожди 2 секунды и повтори клик
- Если появился диалог — обработай через `handle_dialog`
- После каждого поста — сообщи пользователю статус: "Пост N из M запланирован на [дата] [время]"
- Если произошла ошибка при публикации — остановись и спроси пользователя

## Шаг 4: Обновление истории

После успешной публикации всех постов обнови `~/claude-config/skills/threads-weekly-planner/history.md`:
- Добавь все запланированные посты с датами
- Формат записи:

```
## Неделя [дата начала] — [дата конца]

| # | Дата | Время | Заголовок | Формат |
|---|------|-------|-----------|--------|
| 1 | YYYY-MM-DD | HH:MM | Заголовок поста | Формат |
...
```

Закоммить обновлённую историю:
```bash
cd ~/claude-config && git add . && git commit -m "Update: threads history [дата]" && git push
```

## Опционально: Анализ конкурентов

Если в `config.json` указан `competitorUsername`, перед генерацией заголовков:
1. `mcp__chrome-devtools__navigate_page(url: "https://www.threads.com/@{username}")`
2. `mcp__chrome-devtools__take_snapshot()` — получить последние посты
3. Использовать как вдохновение (НЕ копировать)
